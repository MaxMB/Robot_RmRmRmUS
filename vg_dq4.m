function [dq4] = vg_dq4 (q1, q2, q3, q4, q5, dq1, dq2, l3, l4, lB)
dq4 = (-1).*lB.^(-1).*sec(q5).*(cos(q1).*cos(q2+q3)+cos(q2+q3).*sin(q1) ...
  .*tan(q4)+sec(q4).*sin(q2+q3).*tan(q5)).^(-1).*(l3.*(dq2.*sec(q4) ...
  .*sin(q3).*sin(q1+(-1).*q4).*tan(q5)+dq1.*sin(q2).*(cos(q1).^2.* ...
  cos(q2+q3).*sec(q4)+cos(q2+q3).*sec(q4).*sin(q1).^2+cos(q1).*sin( ...
  q2+q3).*tan(q5)+sin(q1).*sin(q2+q3).*tan(q4).*tan(q5)))+(1/2).* ...
  dq1.*l4.*(cos(q1).^2.*sec(q4).*sin(2.*(q2+q3))+2.*cos(q1).*sin(q2+ ...
  q3).^2.*tan(q5)+sin(q1).*(sec(q4).*sin(q1).*sin(2.*(q2+q3))+2.* ...
  sin(q2+q3).^2.*tan(q4).*tan(q5))));