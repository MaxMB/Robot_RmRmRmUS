function [dq3] = vg_dq3 (q1, q2, q3, q4, q5, dq1, dq2, l3, l4)
dq3 = l4.^(-1).*(cos(q1).*cos(q2+q3).*cos(q4).*cos(q5)+cos(q2+q3).*cos( ...
  q5).*sin(q1).*sin(q4)+sin(q2+q3).*sin(q5)).^(-1).*(l3.*(dq1.*cos( ...
  q5).*sin(q2).*sin(q1+(-1).*q4)+(-1).*dq2.*(cos(q1).*cos(q2).*cos( ...
  q4).*cos(q5)+cos(q2).*cos(q5).*sin(q1).*sin(q4)+sin(q2).*sin(q5))) ...
  +l4.*(dq1.*cos(q5).*sin(q2+q3).*sin(q1+(-1).*q4)+(-1).*dq2.*(cos( ...
  q1).*cos(q2+q3).*cos(q4).*cos(q5)+cos(q2+q3).*cos(q5).*sin(q1).* ...
  sin(q4)+sin(q2+q3).*sin(q5))));